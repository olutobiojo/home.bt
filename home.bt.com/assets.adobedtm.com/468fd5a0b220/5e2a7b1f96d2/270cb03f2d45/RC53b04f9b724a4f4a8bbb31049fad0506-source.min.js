// For license information, see `https://assets.adobedtm.com/468fd5a0b220/5e2a7b1f96d2/270cb03f2d45/RC53b04f9b724a4f4a8bbb31049fad0506-source.js`.
_satellite.__registerScript('https://assets.adobedtm.com/468fd5a0b220/5e2a7b1f96d2/270cb03f2d45/RC53b04f9b724a4f4a8bbb31049fad0506-source.min.js', "<script defer src=\"https://www.googletagmanager.com/gtag/js?id=UA-35439723-1\"></script>\n\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag() {\n    dataLayer.push(arguments);\n  }\n  gtag('js', new Date());\n\n  /* Google Consent Mode DIH-6172 */\n  var consentTargeting = _satellite.getVar('Cookie Policy Targeting');\n  var consentPerformance = _satellite.getVar('Cookie Policy Performance');\n\n  if (consentTargeting) {\n    gtag('consent', 'update', {\n      'ad_storage': 'granted',\n      'analytics_storage': 'granted'\n    });\n  }\n\n  /* Google Consent Mode DIH-6172 */\n  var GoogleIDUA = _satellite.getVar('Google Analytics UA');\n  var GoogleIDGA4 = _satellite.getVar('Google Analytics GA4');\n  var userID = _satellite.getVar('BT Consumer User Alias ID');\n  var loginStatus = _satellite.getVar('User login status');\n  var env = _satellite.getVar('Launch Environment');\n  var debugMode = /prod/i.test(env) ? false : true;\n\n  try {\n    if (loginStatus == 'Logged in') {\n      //GA4 Property\n      gtag('config', GoogleIDGA4, {\n        'user_id': userID,\n        'login_status': 'logged in',\n        'user_properties': {\n          'btuserid': userID\n        },\n        'debug_mode': debugMode,\n        'send_page_view': false\n      });\n      \n      gtag('set', {\n        'custom_map': {\n          'dimension25': 'btuserid'\n        }\n      });\n      gtag('config', GoogleIDUA, {\n        'user_id': userID,\n        'btuserid': userID,\n        'anonymize_ip': true\n      });\n      \n    } else {\n      \n\t  gtag('config', GoogleIDGA4, {\n        'debug_mode': debugMode,\n        'login_status': 'logged out',\n        'send_page_view': false\n      });\n\t  \n\t  gtag('config', GoogleIDUA, {\n        'anonymize_ip': true\n      });\n    }\n    gtag('event', 'page_view', {\n        send_to: GoogleIDGA4\n    });\n  } catch (e) {\n    gtag('config', GoogleIDUA, { 'anonymize_ip': true });\n  }\n\n  //DIH-5916 + DIH-6356\n  var s_cid = _satellite.getVar('Campaign ID');\n  var esspid = _satellite.getVar('URL Parameter - esspid');\n  var esskwid = _satellite.getVar('URL Parameter - esskwid');\n  var esscrid = _satellite.getVar('URL Parameter - esscrid');\n  var ess_sacid = _satellite.getVar('URL Parameter - ess_sacid');\n  var btcg = _satellite.getVar('URL Parameter - btcg');\n\n  try {\n    if (esskwid || esspid || s_cid || esscrid || ess_sacid || btcg) {\n      \n\t  //GA4 Property\n      gtag('event', 'Essence Parameter', {\n        's_cid': s_cid,\n        'esspid': esspid,\n        'esskwid': esskwid,\n        'esscrid': esscrid,\n        'ess_sacid': ess_sacid,\n        'btcg': btcg\n      });\n\t  \n\t  \n\t  gtag('set', {\n        'custom_map': {\n          'dimension38': 'dimension38',\n          'dimension39': 'dimension39',\n          'dimension40': 'dimension40',\n          'dimension43': 'dimension43'\n        }\n      });\n      gtag('config', GoogleIDUA, {\n        'dimension38': s_cid,\n        'dimension39': esspid,\n        'dimension40': esskwid,\n        'dimension43': btcg,\n        send_page_view: false\n      });\n\n    }\n  } catch (e) { }\n\n  //DIH-6555 Starts\n  //Basket Products\n  try {\n    var basketProducts,\n      basketFlag;\n    var basketItems = _satellite.getVar('digitalData - Basket Items');\n\n    if (basketItems.length > 0) {\n      for (i = 0; i < basketItems.length; i++) {\n        basketProducts = basketItems[i].product_name;\n        if (basketItems[i].flags.base) {\n          basketFlag = 'base';\n        } else if (basketItems[i].flags.is.acquisition) {\n          basketFlag = 'acquisition';\n        } else {\n          basketFlag = 'na';\n        }\n\t\t\n\t\t//GA4 Property\n        gtag('event', 'Essence DL Product', {\n          'basketProducts': basketProducts,\n          'basketFlag': basketFlag\n        });\n\n        gtag('set', {\n          'custom_map': {\n            'dimension44': 'basketProducts',\n            'dimension45': 'basketFlag'\n          }\n        });\n        gtag('config', _satellite.getVar('Google Analytics UA'), {\n          'basketProducts': basketProducts,\n          'basketFlag': basketFlag,\n          send_page_view: false\n        });\n      }\n    }\n  } catch (e) { }\n\n  //Page Products\n  try {\n    var pageProducts = digitalData.page.products.items;\n    if (pageProducts.length > 0) {\n      for (j = 0; j < pageProducts.length; j++) {\n        var productFlag;\n\n        if (pageProducts[j].flags.base) {\n          productFlag = 'base';\n        } else if (pageProducts[j].flags.is.acquisition) {\n          productFlag = 'acquisition';\n        } else {\n          productFlag = 'na';\n        }\n\n        var pageProductItems = 'name:' + pageProducts[j].product_name + '| category:' + pageProducts[j].category.toString() + '| flags:' + productFlag;\n\n\t\t//GA4 Property\n        gtag('event', 'Essence DL Product', {\n          'pageProductItems': pageProductItems\n        });\n\t\t\n        gtag('set', {\n          'custom_map': {\n            'dimension50': 'pageProductItems'\n          }\n        });\n        gtag('config', GoogleIDUA, {\n          'pageProductItems': pageProductItems,\n          send_page_view: false\n        });\n        \n      }\n    }\n  } catch (e) { }\n\n  //Page category and labels\n  try {\n    var pageCategory = _satellite.getVar('digitalData - Page Category').area;\n    var pageLabels = _satellite.getVar('digitalData - Page Label');\n\t\n\t //GA4 Property\n    gtag('event', 'Essence DL Product', {\n      'pageCategory': pageCategory,\n      'pageLabels': pageLabels\n    });\n\t\n    gtag('set', {\n      'custom_map': {\n        'dimension48': 'pageCategory',\n        'dimension49': 'pageLabels'\n      }\n    });\n    gtag('config', GoogleIDUA, {\n      'pageCategory': pageCategory,\n      'pageLabels': pageLabels,\n      send_page_view: false\n    });\n\n  } catch (e) { }\n  //User and account data\n  try {\n    var accountProductHoldings = _satellite.getVar('digitalData - accountProductHoldings');\n    var accountUser = _satellite.getVar('digitalData - Account User Role');\n    var userLastLogin = _satellite.getVar('digitalData - userLastLogin');\n    var userMemberSince = _satellite.getVar('digitalData - userMemberSince');\n    \n    if (accountProductHoldings || accountUser || userLastLogin || userMemberSince) {\n\t\t\n\t//GA4 Property\n      gtag('event', 'Essence DL Product', {\n        'accountProductHoldings': accountProductHoldings,\n        'accountUser': accountUser\n      });\n\t  \n      gtag('set', {\n        'custom_map': {\n          'dimension46': 'accountProductHoldings',\n          'dimension47': 'accountUser',\n          'dimension52': 'userLastLogin',\n          'dimension53': 'userMemberSince'\n        }\n      });\n\n      gtag('config', GoogleIDUA, {\n        'accountProductHoldings': accountProductHoldings,\n        'accountUser': accountUser,\n        'userLastLogin': userLastLogin,\n        'userMemberSince': userMemberSince,\n        send_page_view: false\n      });\n      \n    }\n  } catch (e) { }\n//DIH-6555 Ends\n</script>");